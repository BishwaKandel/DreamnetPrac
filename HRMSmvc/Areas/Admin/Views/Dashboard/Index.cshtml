@using Domain.Models
@model IEnumerable<User>
@{
    ViewData["Title"] = "Fetching Data from Web API";
}
@{
    int counter = 1;
    <!-- Initialize a counter to 1 -->
}


@* <div class="pagetitle">
            <h1>General Tables</h1>
            <nav>
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                    <li class="breadcrumb-item">Tables</li>
                    <li class="breadcrumb-item active">General</li>
                </ol>
            </nav> 
        </div><!-- End Page Title --> *@
<div class="card">
    <div class="card-body">
        <h5 class="card-title">List of Employees</h5>
        <!-- Default Table -->
        <table class="table">
            <thead>
                <tr>
                    @* <th scope="col">ID</th> *@
                    <th scope="col">S.N.</th>
                    <th scope="col">First Name</th>
                    <th scope="col">Last Name</th>
                    <th scope="col">Email</th>
                    <th scope="col">PhoneNumber</th>
                    <th scope="col">DateOfBirth</th>
                    <th scope="col">JoiningDate</th>
                    <th scope="col">Position</th>
                    <th scope="col">Salary</th>
                    <th scope="col">Address</th>
                    <th scope="col">Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var row in Model)
                {
                    <tr>
                        @* <td>@row.Id</td> *@
                        <td>@counter</td>
                        <td>@row.FirstName</td>
                        <td>@row.LastName</td>
                        <td>@row.Email</td>
                        <td>@row.PhoneNumber</td>
                        <td>@row.DOB.ToShortDateString()</td>
                        <td>@row.JoiningDate.ToShortDateString()</td>
                        <td>@row.Position</td>
                        <td>@row.Salary</td>
                        <td>@row.Address</td>
                        <td>
                            <a href="/Employee/CreateorEdit?id=@row.Id">
                                <i class="fa-solid fa-pen"></i>
                            </a>
                        </td>
                        <td>
                            <a href="" class="delete-btn" data-id="@row.Id">
                                <i class="fa-solid fa-trash"></i>
                            </a>
                        </td>
                    </tr>
                    counter++;
                }
            </tbody>
        </table>
    </div>
</div>

@section Scripts {
    <script>
        $(document).on("click", ".delete-btn", function () {
            var id = $(this).data("id");

            if (confirm("Are you sure you want to delete this employee?")) {
                $.ajax({
                        type: 'POST',
                    url: '@Url.Action("Employee", "Delete")',
                    data: { id: id },
                    success: function (response) {
                        if (response.success) {
                            alert(response.message);
                            location.reload(); // refresh table
                        } else {
                            alert(response.message);
                        }
                    },
                    error: function () {
                        alert("Something went wrong!");
                    }
                });
            }
        });

    </script>
}


